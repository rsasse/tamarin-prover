rule Init_1:
  [ Fr(~ekI) ]
  -->
  [ Init_1( $I, $R, ~ekI )
  , Out( <$I, $R, 'g' ^ ~ekI> ) ]

rule Init_2:
    let Y = 'g'^~s
    in
    [ Init_1( $I, $R, ~ekI )
    , In( <$R, $I, Y> ) 
    ]
  --[ SessionKey($I,$R, Y ^ ~ekI) ]->
    []
